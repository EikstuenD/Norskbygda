<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ord-Mesteren: Bygg Din Landsby</title>
    <style>
        :root {
            --bg-color: #f0f4f8;
            --panel-bg: #ffffff;
            --primary: #4a90e2;
            --wood-color: #d35400;
            --stone-color: #7f8c8d;
            --gold-color: #f1c40f;
            --success: #2ecc71;
            --danger: #e74c3c;
            --text-main: #2c3e50;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Hindre scrolling p√• hovedsiden */
        }

        /* --- LAYOUT: SPLIT SCREEN --- */
        #main-container {
            display: flex;
            flex: 1;
            height: 100%;
        }

        /* Left Panel: Tasks */
        #task-panel {
            flex: 1;
            padding: 20px;
            background-color: var(--panel-bg);
            border-right: 2px solid #ddd;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            position: relative;
        }

        /* Right Panel: Village */
        #village-panel {
            flex: 1;
            background: linear-gradient(to bottom, #87CEEB 60%, #2ecc71 60%); /* Sky and Grass */
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        h2 { margin-top: 0; font-size: 1.5rem; }

        /* --- RESOURCE BAR --- */
        #resource-bar {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-around;
            font-weight: bold;
            font-size: 1.2rem;
            z-index: 10;
        }
        .res-icon { margin-right: 5px; }

        /* --- MISSION SELECTOR (New Feature) --- */
        #mission-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .mission-card {
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            text-align: center;
            flex: 1;
            transition: all 0.2s;
            opacity: 0.6;
        }
        
        .mission-card.active {
            border-color: var(--primary);
            background-color: #ebf5ff;
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* --- QUIZ AREA --- */
        #quiz-area {
            text-align: center;
            margin-top: 20px;
        }

        #target-word {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
        }

        .btn-option {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 1.2rem;
            background-color: #eee;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-option:hover { background-color: #ddd; }

        .btn-speak {
            background: none;
            border: 2px solid var(--primary);
            color: var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
            margin-left: 10px;
        }

        /* --- VILLAGE GRID --- */
        #village-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            padding: 20px;
            height: 60%; /* Occupy bottom part (grass) */
            position: absolute;
            bottom: 0;
            width: 100%;
            box-sizing: border-box;
        }

        .plot {
            border: 2px dashed rgba(255,255,255,0.3);
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: transform 0.2s;
            background-color: rgba(0,0,0,0.05);
        }
        .plot:hover { background-color: rgba(255,255,255,0.2); }
        
        /* Build Menu Overlay */
        #build-menu {
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            width: 80%;
            display: none; /* Hidden by default */
            z-index: 100;
        }
        
        .build-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding: 10px 0;
        }
        .build-btn {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
        .build-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* --- Feedback & Animations --- */
        #feedback {
            height: 40px;
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        /* Mobile tweak */
        @media (max-width: 768px) {
            #main-container { flex-direction: column; }
            #task-panel { flex: 1; border-right: none; border-bottom: 2px solid #ddd; }
            #village-panel { flex: 1; }
            #village-grid { height: 100%; padding-top: 60px;} /* Full height on mobile bottom */
        }
    </style>
</head>
<body>

    <div id="resource-bar">
        <span>üí∞ Gull: <span id="res-gold">0</span></span>
        <span>ü™µ Treverk: <span id="res-wood">0</span></span>
        <span>ü™® Stein: <span id="res-stone">0</span></span>
    </div>

    <div id="main-container">
        
        <div id="task-panel">
            <h2>üë∑ Arbeidsrommet</h2>
            <p>Velg hva du vil jobbe for:</p>
            
            <div id="mission-selector">
                <div class="mission-card active" onclick="setMission('wood')">
                    <div style="font-size:2rem">üå≤</div>
                    <div>Skogen</div>
                    <small>F√• Treverk</small>
                </div>
                <div class="mission-card" onclick="setMission('stone')">
                    <div style="font-size:2rem">‚õèÔ∏è</div>
                    <div>Gruva</div>
                    <small>F√• Stein</small>
                </div>
                <div class="mission-card" onclick="setMission('gold')">
                    <div style="font-size:2rem">‚öñÔ∏è</div>
                    <div>Torget</div>
                    <small>F√• Gull</small>
                </div>
            </div>

            <div id="quiz-area">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <span id="mode-label" style="background:#eee; padding:5px 10px; border-radius:5px; font-size:0.9rem;">Synonym</span>
                    <button class="btn-option" style="width:auto; margin:0; padding:5px 15px; background:#ddd;" onclick="toggleMode()">Bytt modus ‚ü≥</button>
                </div>
                
                <p id="question-text">Hva betyr det samme som...</p>
                
                <div style="display:flex; align-items:center; justify-content:center;">
                    <div id="target-word">ORDET</div>
                    <button class="btn-speak" onclick="speakWord()" title="Les opp">üîä</button>
                </div>

                <div id="options-container">
                    </div>
                <div id="feedback"></div>
            </div>
        </div>

        <div id="village-panel">
            <button onclick="toggleBuildMenu()" style="position:absolute; top:10px; right:10px; z-index:20; padding:10px; background:white; border:none; border-radius:5px; font-weight:bold; cursor:pointer;">üî® Byggemeny</button>
            
            <div id="build-menu">
                <h3>Velg hva du vil bygge</h3>
                <div id="build-list">
                    </div>
                <button onclick="toggleBuildMenu()" style="margin-top:10px; width:100%; padding:10px;">Lukk</button>
            </div>

            <div id="village-grid">
                <div class="plot" onclick="placeBuilding(0)"></div>
                <div class="plot" onclick="placeBuilding(1)"></div>
                <div class="plot" onclick="placeBuilding(2)"></div>
                <div class="plot" onclick="placeBuilding(3)"></div>
                <div class="plot" onclick="placeBuilding(4)"></div>
                <div class="plot" onclick="placeBuilding(5)"></div>
                <div class="plot" onclick="placeBuilding(6)"></div>
                <div class="plot" onclick="placeBuilding(7)"></div>
                <div class="plot" onclick="placeBuilding(8)"></div>
                <div class="plot" onclick="placeBuilding(9)"></div>
                <div class="plot" onclick="placeBuilding(10)"></div>
                <div class="plot" onclick="placeBuilding(11)"></div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const synonyms = [
            { word: "Glad", correct: "Lykkelig", distractors: ["Sint", "Trist"] },
            { word: "Liten", correct: "Sm√•", distractors: ["Stor", "H√∏y"] },
            { word: "Hjelpe", correct: "Bist√•", distractors: ["√òdelegge", "Stoppe"] },
            { word: "Venn", correct: "Kamerat", distractors: ["Fiende", "Fremmed"] },
            { word: "Hus", correct: "Bolig", distractors: ["Bil", "B√•t"] },
            { word: "Rope", correct: "Skrike", distractors: ["Hviske", "Snakke"] },
            { word: "Se", correct: "Kikke", distractors: ["H√∏re", "Lukte"] },
            { word: "G√•", correct: "Spasere", distractors: ["L√∏pe", "Sitte"] },
            { word: "Redd", correct: "Engstelig", distractors: ["T√∏ff", "Modig"] },
            { word: "Gave", correct: "Presang", distractors: ["Brev", "Pakke"] }
        ];

        const antonyms = [
            { word: "Varm", correct: "Kald", distractors: ["Sulten", "V√•t"] },
            { word: "Stor", correct: "Liten", distractors: ["H√∏y", "Bred"] },
            { word: "Dag", correct: "Natt", distractors: ["Kveld", "Morgen"] },
            { word: "Full", correct: "Tom", distractors: ["Halv", "Tung"] },
            { word: "Billig", correct: "Dyr", distractors: ["Fin", "Rik"] },
            { word: "Opp", correct: "Ned", distractors: ["Bort", "Inn"] },
            { word: "Inn", correct: "Ut", distractors: ["Opp", "Fram"] },
            { word: "Svart", correct: "Hvit", distractors: ["R√∏d", "Gr√∏nn"] },
            { word: "Ung", correct: "Gammel", distractors: ["Ny", "Voksen"] },
            { word: "T√∏rr", correct: "V√•t", distractors: ["Kald", "Ren"] }
        ];

        // --- GAME STATE ---
        let resources = { gold: 0, wood: 0, stone: 0 };
        let currentMission = 'wood'; // 'wood', 'stone', 'gold'
        let currentMode = 'synonyms'; // 'synonyms' or 'antonyms'
        let currentQuestion = {};
        let selectedBuilding = null; // What we are trying to build

        // Building Types and Costs
        const buildings = [
            { id: 'tent', name: 'Lite Telt', icon: '‚õ∫', cost: { wood: 2, gold: 0, stone: 0 } },
            { id: 'cabin', name: 'Hytte', icon: 'üè†', cost: { wood: 5, gold: 2, stone: 0 } },
            { id: 'house', name: 'Bolighus', icon: 'üè°', cost: { wood: 10, gold: 5, stone: 2 } },
            { id: 'bakery', name: 'Bakeri', icon: 'ü•ê', cost: { wood: 8, gold: 10, stone: 5 } },
            { id: 'smith', name: 'Smed', icon: '‚öîÔ∏è', cost: { wood: 5, gold: 5, stone: 10 } },
            { id: 'farm', name: 'Bondeg√•rd', icon: 'üöú', cost: { wood: 15, gold: 10, stone: 5 } },
            { id: 'park', name: 'Park', icon: 'üå≥', cost: { wood: 2, gold: 5, stone: 2 } },
            { id: 'castle', name: 'Slott', icon: 'üè∞', cost: { wood: 50, gold: 50, stone: 50 } }
        ];

        // --- INITIALIZATION ---
        window.onload = function() {
            nextQuestion();
            updateUI();
        };

        // --- LOGIC: MISSION & QUIZ ---

        function setMission(type) {
            currentMission = type;
            // Update Visuals
            document.querySelectorAll('.mission-card').forEach(el => el.classList.remove('active'));
            if(type === 'wood') document.querySelector('.mission-card:nth-child(1)').classList.add('active');
            if(type === 'stone') document.querySelector('.mission-card:nth-child(2)').classList.add('active');
            if(type === 'gold') document.querySelector('.mission-card:nth-child(3)').classList.add('active');
        }

        function toggleMode() {
            currentMode = (currentMode === 'synonyms') ? 'antonyms' : 'synonyms';
            document.getElementById('mode-label').innerText = (currentMode === 'synonyms') ? 'Synonym (Likt)' : 'Antonym (Motsatt)';
            document.getElementById('question-text').innerText = (currentMode === 'synonyms') ? 'Hva betyr det samme som...' : 'Hva er det motsatte av...';
            nextQuestion();
        }

        function nextQuestion() {
            const pool = (currentMode === 'synonyms') ? synonyms : antonyms;
            const randIndex = Math.floor(Math.random() * pool.length);
            currentQuestion = pool[randIndex];

            document.getElementById('target-word').innerText = currentQuestion.word;
            document.getElementById('feedback').innerText = "";

            const container = document.getElementById('options-container');
            container.innerHTML = "";

            let options = [currentQuestion.correct, ...currentQuestion.distractors];
            options.sort(() => Math.random() - 0.5); // Shuffle

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'btn-option';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt);
                container.appendChild(btn);
            });
        }

        function checkAnswer(answer) {
            const isCorrect = (answer === currentQuestion.correct);
            const feedbackEl = document.getElementById('feedback');
            
            if (isCorrect) {
                // Reward Logic
                let rewardText = "";
                if(currentMission === 'wood') { resources.wood += 2; rewardText = "+2 ü™µ"; }
                if(currentMission === 'stone') { resources.stone += 2; rewardText = "+2 ü™®"; }
                if(currentMission === 'gold') { resources.gold += 5; rewardText = "+5 üí∞"; }
                
                feedbackEl.innerHTML = `<span style="color:var(--success)">Riktig! Du fikk ${rewardText}</span>`;
                updateUI();
                
                // Wait slightly then next question
                setTimeout(nextQuestion, 1500);
            } else {
                feedbackEl.innerHTML = `<span style="color:var(--danger)">Feil. Pr√∏v igjen!</span>`;
            }
        }

        function speakWord() {
            const msg = new SpeechSynthesisUtterance();
            msg.text = currentQuestion.word;
            msg.lang = 'no-NO';
            window.speechSynthesis.speak(msg);
        }

        // --- LOGIC: BUILDING ---

        function updateUI() {
            document.getElementById('res-gold').innerText = resources.gold;
            document.getElementById('res-wood').innerText = resources.wood;
            document.getElementById('res-stone').innerText = resources.stone;
            renderBuildList();
        }

        function toggleBuildMenu() {
            const menu = document.getElementById('build-menu');
            menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
            renderBuildList();
        }

        function renderBuildList() {
            const list = document.getElementById('build-list');
            list.innerHTML = "";
            
            buildings.forEach(b => {
                const canAfford = (resources.wood >= b.cost.wood && resources.gold >= b.cost.gold && resources.stone >= b.cost.stone);
                
                const div = document.createElement('div');
                div.className = 'build-item';
                div.innerHTML = `
                    <div>
                        <span style="font-size:1.5rem">${b.icon}</span> 
                        <strong>${b.name}</strong><br>
                        <small>Tre: ${b.cost.wood} | Stein: ${b.cost.stone} | Gull: ${b.cost.gold}</small>
                    </div>
                    <button class="build-btn" ${canAfford ? '' : 'disabled'} onclick="selectBuilding('${b.id}')">
                        ${canAfford ? 'Velg' : 'Mangler r√•d'}
                    </button>
                `;
                list.appendChild(div);
            });
        }

        function selectBuilding(id) {
            selectedBuilding = buildings.find(b => b.id === id);
            toggleBuildMenu(); // Hide menu
            alert(`Du valgte ${selectedBuilding.name}. Klikk p√• en ledig rute i gresset for √• bygge!`);
        }

        function placeBuilding(plotIndex) {
            if (!selectedBuilding) {
                alert("Du m√• velge et bygg i menyen f√∏rst!");
                return;
            }

            // Deduct cost
            if(resources.wood < selectedBuilding.cost.wood || resources.gold < selectedBuilding.cost.gold || resources.stone < selectedBuilding.cost.stone) {
                alert("Du har brukt opp ressursene dine!");
                selectedBuilding = null;
                return;
            }

            resources.wood -= selectedBuilding.cost.wood;
            resources.gold -= selectedBuilding.cost.gold;
            resources.stone -= selectedBuilding.cost.stone;

            // Place visual
            const plots = document.querySelectorAll('.plot');
            plots[plotIndex].innerText = selectedBuilding.icon;
            plots[plotIndex].style.backgroundColor = "rgba(255,255,255,0.6)";
            plots[plotIndex].onclick = null; // Prevent overwriting (simple version)

            // Reset
            selectedBuilding = null;
            updateUI();
        }

    </script>
</body>
</html>
